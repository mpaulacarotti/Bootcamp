{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8012650e-38d8-4074-b70f-87160856eb3a",
   "metadata": {},
   "source": [
    "### Lesson 49"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "70b22eb9-84a1-4416-936c-6d3fbcab5bef",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import datetime as dt\n",
    "from datetime import datetime, timedelta # Additional 'nested' library within datetime library\n",
    "from datetime import date"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a375fe4b-dcd6-4ddb-97be-755ec02c4870",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Multiple ways to import an excel file\n",
    "ss = pd.ExcelFile('Sample Superstore.xlsx')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "e136af65-9625-4b4f-9fe4-50ecaecac039",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "pandas.io.excel._base.ExcelFile"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# check our data type\n",
    "type(ss)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "2f7b2322-8a83-4d90-8a30-73ed26a03ccd",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "3"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Count of sheets\n",
    "len(ss.sheet_names)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "471078dc-bbda-4b45-9dbc-fa1d527e261d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['Orders', 'Returns', 'People']"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Sheet names\n",
    "ss.sheet_names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "1a8e87a3-5b0b-402a-b86d-c1d8dde3952f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Row ID</th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Ship Mode</th>\n",
       "      <th>Customer ID</th>\n",
       "      <th>Customer Name</th>\n",
       "      <th>Segment</th>\n",
       "      <th>Country</th>\n",
       "      <th>City</th>\n",
       "      <th>...</th>\n",
       "      <th>Postal Code</th>\n",
       "      <th>Region</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Product Name</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Discount</th>\n",
       "      <th>Profit</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>42420</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>Bush Somerset Collection Bookcase</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>41.9136</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>42420</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>219.5820</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>DV-13045</td>\n",
       "      <td>Darrin Van Huff</td>\n",
       "      <td>Corporate</td>\n",
       "      <td>United States</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>...</td>\n",
       "      <td>90036</td>\n",
       "      <td>West</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>Self-Adhesive Address Labels for Typewriters b...</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.8714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>33311</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>Bretford CR4500 Series Slim Rectangular Table</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>5</td>\n",
       "      <td>0.45</td>\n",
       "      <td>-383.0310</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>33311</td>\n",
       "      <td>South</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>Eldon Fold 'N Roll Cart System</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>0.20</td>\n",
       "      <td>2.5164</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Row ID        Order ID Order Date  Ship Date       Ship Mode Customer ID  \\\n",
       "0       1  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "1       2  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "2       3  CA-2013-138688 2013-06-13 2013-06-17    Second Class    DV-13045   \n",
       "3       4  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "4       5  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "\n",
       "     Customer Name    Segment        Country             City  ...  \\\n",
       "0      Claire Gute   Consumer  United States        Henderson  ...   \n",
       "1      Claire Gute   Consumer  United States        Henderson  ...   \n",
       "2  Darrin Van Huff  Corporate  United States      Los Angeles  ...   \n",
       "3   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...   \n",
       "4   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...   \n",
       "\n",
       "  Postal Code  Region       Product ID         Category Sub-Category  \\\n",
       "0       42420   South  FUR-BO-10001798        Furniture    Bookcases   \n",
       "1       42420   South  FUR-CH-10000454        Furniture       Chairs   \n",
       "2       90036    West  OFF-LA-10000240  Office Supplies       Labels   \n",
       "3       33311   South  FUR-TA-10000577        Furniture       Tables   \n",
       "4       33311   South  OFF-ST-10000760  Office Supplies      Storage   \n",
       "\n",
       "                                        Product Name     Sales  Quantity  \\\n",
       "0                  Bush Somerset Collection Bookcase  261.9600         2   \n",
       "1  Hon Deluxe Fabric Upholstered Stacking Chairs,...  731.9400         3   \n",
       "2  Self-Adhesive Address Labels for Typewriters b...   14.6200         2   \n",
       "3      Bretford CR4500 Series Slim Rectangular Table  957.5775         5   \n",
       "4                     Eldon Fold 'N Roll Cart System   22.3680         2   \n",
       "\n",
       "   Discount    Profit  \n",
       "0      0.00   41.9136  \n",
       "1      0.00  219.5820  \n",
       "2      0.00    6.8714  \n",
       "3      0.45 -383.0310  \n",
       "4      0.20    2.5164  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Now that we know the sheet names, we can import the sheet one by one and create them into DataFrames\n",
    "# the read_excel function will bring in the sheet\n",
    "# if we do not specify a sheet, it will just automatically import the first sheet\n",
    "ss_orders = pd.read_excel('Sample Superstore.xlsx')\n",
    "ss_orders.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "70da8b28-91b4-4d6c-9c4f-accb360519d9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Returned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2014-153822</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2014-129707</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-152345</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2012-156440</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2014-155999</td>\n",
       "      <td>Yes</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID Returned\n",
       "0  CA-2014-153822      Yes\n",
       "1  CA-2014-129707      Yes\n",
       "2  CA-2011-152345      Yes\n",
       "3  CA-2012-156440      Yes\n",
       "4  US-2014-155999      Yes"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Use read_excel, but this time we specify the sheet we want to import\n",
    "# import as DF\n",
    "ss_returns = pd.read_excel('Sample Superstore.xlsx', 'Returns')\n",
    "ss_returns = ss_returns[['Order ID', 'Returned']] # Swapping our columns\n",
    "    # Doing this because later on we are going to merge this table with another\n",
    "    # When we merge, the merge has to be on the first column\n",
    "ss_returns.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "0af5c842-a7d8-472d-86c9-33849345b114",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Person</th>\n",
       "      <th>Region</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Anna Andreadi</td>\n",
       "      <td>West</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Chuck Magee</td>\n",
       "      <td>East</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Kelly Williams</td>\n",
       "      <td>Central</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Cassandra Brandow</td>\n",
       "      <td>South</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              Person   Region\n",
       "0      Anna Andreadi     West\n",
       "1        Chuck Magee     East\n",
       "2     Kelly Williams  Central\n",
       "3  Cassandra Brandow    South"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Import DF\n",
    "ss_people = pd.read_excel('Sample Superstore.xlsx', 'People')\n",
    "ss_people.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "e32c4271-97a0-4f96-8892-4f333ae3a236",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(9994, 21)\n",
      "9994\n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 9994 entries, 0 to 9993\n",
      "Data columns (total 21 columns):\n",
      " #   Column         Non-Null Count  Dtype         \n",
      "---  ------         --------------  -----         \n",
      " 0   Row ID         9994 non-null   int64         \n",
      " 1   Order ID       9994 non-null   object        \n",
      " 2   Order Date     9994 non-null   datetime64[ns]\n",
      " 3   Ship Date      9994 non-null   datetime64[ns]\n",
      " 4   Ship Mode      9994 non-null   object        \n",
      " 5   Customer ID    9994 non-null   object        \n",
      " 6   Customer Name  9994 non-null   object        \n",
      " 7   Segment        9994 non-null   object        \n",
      " 8   Country        9994 non-null   object        \n",
      " 9   City           9994 non-null   object        \n",
      " 10  State          9994 non-null   object        \n",
      " 11  Postal Code    9994 non-null   int64         \n",
      " 12  Region         9994 non-null   object        \n",
      " 13  Product ID     9994 non-null   object        \n",
      " 14  Category       9994 non-null   object        \n",
      " 15  Sub-Category   9994 non-null   object        \n",
      " 16  Product Name   9994 non-null   object        \n",
      " 17  Sales          9994 non-null   float64       \n",
      " 18  Quantity       9994 non-null   int64         \n",
      " 19  Discount       9994 non-null   float64       \n",
      " 20  Profit         9994 non-null   float64       \n",
      "dtypes: datetime64[ns](2), float64(3), int64(3), object(13)\n",
      "memory usage: 1.6+ MB\n",
      "None\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "21"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Number of rows/cols for Orders DF\n",
    "# Multiple ways to check this\n",
    "print(ss_orders.shape) # this will give us rows and columns\n",
    "print(len(ss_orders)) # this will give us just rows\n",
    "print(ss_orders.info()) # this is the most informative: col names, col count, \n",
    "                        #row count, data type for each col. notice how col count starts at 0\n",
    "len(ss_orders.columns) # column count"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "f6cbdf23-a518-49de-bf71-de087c24a045",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Row ID</th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Ship Mode</th>\n",
       "      <th>Customer ID</th>\n",
       "      <th>Customer Name</th>\n",
       "      <th>Segment</th>\n",
       "      <th>Country</th>\n",
       "      <th>City</th>\n",
       "      <th>...</th>\n",
       "      <th>Region</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Product Name</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Discount</th>\n",
       "      <th>Profit</th>\n",
       "      <th>Person</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>Bush Somerset Collection Bookcase</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>41.9136</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>219.5820</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>DV-13045</td>\n",
       "      <td>Darrin Van Huff</td>\n",
       "      <td>Corporate</td>\n",
       "      <td>United States</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>...</td>\n",
       "      <td>West</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>Self-Adhesive Address Labels for Typewriters b...</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.8714</td>\n",
       "      <td>Anna Andreadi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>South</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>Bretford CR4500 Series Slim Rectangular Table</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>5</td>\n",
       "      <td>0.45</td>\n",
       "      <td>-383.0310</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>South</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>Eldon Fold 'N Roll Cart System</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>0.20</td>\n",
       "      <td>2.5164</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Row ID        Order ID Order Date  Ship Date       Ship Mode Customer ID  \\\n",
       "0       1  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "1       2  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "2       3  CA-2013-138688 2013-06-13 2013-06-17    Second Class    DV-13045   \n",
       "3       4  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "4       5  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "\n",
       "     Customer Name    Segment        Country             City  ... Region  \\\n",
       "0      Claire Gute   Consumer  United States        Henderson  ...  South   \n",
       "1      Claire Gute   Consumer  United States        Henderson  ...  South   \n",
       "2  Darrin Van Huff  Corporate  United States      Los Angeles  ...   West   \n",
       "3   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...  South   \n",
       "4   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...  South   \n",
       "\n",
       "        Product ID         Category Sub-Category  \\\n",
       "0  FUR-BO-10001798        Furniture    Bookcases   \n",
       "1  FUR-CH-10000454        Furniture       Chairs   \n",
       "2  OFF-LA-10000240  Office Supplies       Labels   \n",
       "3  FUR-TA-10000577        Furniture       Tables   \n",
       "4  OFF-ST-10000760  Office Supplies      Storage   \n",
       "\n",
       "                                        Product Name     Sales Quantity  \\\n",
       "0                  Bush Somerset Collection Bookcase  261.9600        2   \n",
       "1  Hon Deluxe Fabric Upholstered Stacking Chairs,...  731.9400        3   \n",
       "2  Self-Adhesive Address Labels for Typewriters b...   14.6200        2   \n",
       "3      Bretford CR4500 Series Slim Rectangular Table  957.5775        5   \n",
       "4                     Eldon Fold 'N Roll Cart System   22.3680        2   \n",
       "\n",
       "   Discount    Profit             Person  \n",
       "0      0.00   41.9136  Cassandra Brandow  \n",
       "1      0.00  219.5820  Cassandra Brandow  \n",
       "2      0.00    6.8714      Anna Andreadi  \n",
       "3      0.45 -383.0310  Cassandra Brandow  \n",
       "4      0.20    2.5164  Cassandra Brandow  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Inner Join using function merge\n",
    "# Start with larger dataset\n",
    "# arguments in merge: \n",
    "    # how do we want to join this\n",
    "    # what to join this on\n",
    "    # and what column\n",
    "order_people = ss_orders.merge(ss_people, how = 'inner', on = 'Region', suffixes = ('_Old', '_New'))\n",
    "order_people.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "305565a5-e9fc-476c-8c3c-df37b73bbb56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Row ID</th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Ship Mode</th>\n",
       "      <th>Customer ID</th>\n",
       "      <th>Customer Name</th>\n",
       "      <th>Segment</th>\n",
       "      <th>Country</th>\n",
       "      <th>City</th>\n",
       "      <th>...</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Product Name</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Discount</th>\n",
       "      <th>Profit</th>\n",
       "      <th>Person</th>\n",
       "      <th>Returned</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>Bush Somerset Collection Bookcase</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>41.9136</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>CG-12520</td>\n",
       "      <td>Claire Gute</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Henderson</td>\n",
       "      <td>...</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>Hon Deluxe Fabric Upholstered Stacking Chairs,...</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>3</td>\n",
       "      <td>0.00</td>\n",
       "      <td>219.5820</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Second Class</td>\n",
       "      <td>DV-13045</td>\n",
       "      <td>Darrin Van Huff</td>\n",
       "      <td>Corporate</td>\n",
       "      <td>United States</td>\n",
       "      <td>Los Angeles</td>\n",
       "      <td>...</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>Self-Adhesive Address Labels for Typewriters b...</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>2</td>\n",
       "      <td>0.00</td>\n",
       "      <td>6.8714</td>\n",
       "      <td>Anna Andreadi</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>Bretford CR4500 Series Slim Rectangular Table</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>5</td>\n",
       "      <td>0.45</td>\n",
       "      <td>-383.0310</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Standard Class</td>\n",
       "      <td>SO-20335</td>\n",
       "      <td>Sean O'Donnell</td>\n",
       "      <td>Consumer</td>\n",
       "      <td>United States</td>\n",
       "      <td>Fort Lauderdale</td>\n",
       "      <td>...</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>Eldon Fold 'N Roll Cart System</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>0.20</td>\n",
       "      <td>2.5164</td>\n",
       "      <td>Cassandra Brandow</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   Row ID        Order ID Order Date  Ship Date       Ship Mode Customer ID  \\\n",
       "0       1  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "1       2  CA-2013-152156 2013-11-09 2013-11-12    Second Class    CG-12520   \n",
       "2       3  CA-2013-138688 2013-06-13 2013-06-17    Second Class    DV-13045   \n",
       "3       4  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "4       5  US-2012-108966 2012-10-11 2012-10-18  Standard Class    SO-20335   \n",
       "\n",
       "     Customer Name    Segment        Country             City  ...  \\\n",
       "0      Claire Gute   Consumer  United States        Henderson  ...   \n",
       "1      Claire Gute   Consumer  United States        Henderson  ...   \n",
       "2  Darrin Van Huff  Corporate  United States      Los Angeles  ...   \n",
       "3   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...   \n",
       "4   Sean O'Donnell   Consumer  United States  Fort Lauderdale  ...   \n",
       "\n",
       "        Product ID         Category Sub-Category  \\\n",
       "0  FUR-BO-10001798        Furniture    Bookcases   \n",
       "1  FUR-CH-10000454        Furniture       Chairs   \n",
       "2  OFF-LA-10000240  Office Supplies       Labels   \n",
       "3  FUR-TA-10000577        Furniture       Tables   \n",
       "4  OFF-ST-10000760  Office Supplies      Storage   \n",
       "\n",
       "                                        Product Name     Sales Quantity  \\\n",
       "0                  Bush Somerset Collection Bookcase  261.9600        2   \n",
       "1  Hon Deluxe Fabric Upholstered Stacking Chairs,...  731.9400        3   \n",
       "2  Self-Adhesive Address Labels for Typewriters b...   14.6200        2   \n",
       "3      Bretford CR4500 Series Slim Rectangular Table  957.5775        5   \n",
       "4                     Eldon Fold 'N Roll Cart System   22.3680        2   \n",
       "\n",
       "  Discount    Profit             Person  Returned  \n",
       "0     0.00   41.9136  Cassandra Brandow       NaN  \n",
       "1     0.00  219.5820  Cassandra Brandow       NaN  \n",
       "2     0.00    6.8714      Anna Andreadi       NaN  \n",
       "3     0.45 -383.0310  Cassandra Brandow       NaN  \n",
       "4     0.20    2.5164  Cassandra Brandow       NaN  \n",
       "\n",
       "[5 rows x 23 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Left Join\n",
    "order_people_returns = order_people.merge(ss_returns, how = 'left', on = 'Order ID', suffixes = ('_Old', '_New'))\n",
    "order_people_returns.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "2639db94-1087-41ed-a72e-639186f44050",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "9194\n",
      "800\n"
     ]
    }
   ],
   "source": [
    "# How many nulls do we have in the 'Returned' column?\n",
    "print(order_people_returns['Returned'].isnull().sum())\n",
    "print(order_people_returns['Returned'].notnull().sum())\n",
    "# Seems like a lot, let's check our work"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "6246d6e6-145f-4a7d-8755-d085a60dd4b3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "296"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check the number of rows in the returns table\n",
    "len(ss_returns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "43ebee4c-c37a-403b-8c42-32a40a2cd971",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  \n",
       "0    Bookcases      NaN  261.9600  \n",
       "1       Chairs      NaN  731.9400  \n",
       "2       Labels      NaN   14.6200  \n",
       "3       Tables      NaN  957.5775  \n",
       "4      Storage      NaN   22.3680  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create subset of data\n",
    "# Columns: Order ID, product ID, Category, Subcategory, Returned, Sales\n",
    "return_items = order_people_returns[['Order ID', 'Product ID', 'Order Date','Ship Date','Category', 'Sub-Category', 'Returned', 'Sales']]\n",
    "return_items.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "55b7caac-1ddb-4f36-8151-1cccdaefd425",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>CA-2011-143336</td>\n",
       "      <td>OFF-AR-10003056</td>\n",
       "      <td>2011-08-27</td>\n",
       "      <td>2011-09-01</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>Yes</td>\n",
       "      <td>8.560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>CA-2011-143336</td>\n",
       "      <td>TEC-PH-10001949</td>\n",
       "      <td>2011-08-27</td>\n",
       "      <td>2011-09-01</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Phones</td>\n",
       "      <td>Yes</td>\n",
       "      <td>213.480</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>CA-2011-143336</td>\n",
       "      <td>OFF-BI-10002215</td>\n",
       "      <td>2011-08-27</td>\n",
       "      <td>2011-09-01</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Binders</td>\n",
       "      <td>Yes</td>\n",
       "      <td>22.720</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>55</th>\n",
       "      <td>CA-2013-111682</td>\n",
       "      <td>OFF-ST-10000604</td>\n",
       "      <td>2013-06-18</td>\n",
       "      <td>2013-06-19</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>Yes</td>\n",
       "      <td>208.560</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>CA-2013-111682</td>\n",
       "      <td>OFF-PA-10001569</td>\n",
       "      <td>2013-06-18</td>\n",
       "      <td>2013-06-19</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Paper</td>\n",
       "      <td>Yes</td>\n",
       "      <td>32.400</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9957</th>\n",
       "      <td>US-2011-143287</td>\n",
       "      <td>OFF-PA-10004039</td>\n",
       "      <td>2011-11-11</td>\n",
       "      <td>2011-11-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Paper</td>\n",
       "      <td>Yes</td>\n",
       "      <td>223.920</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9958</th>\n",
       "      <td>US-2011-143287</td>\n",
       "      <td>OFF-SU-10001574</td>\n",
       "      <td>2011-11-11</td>\n",
       "      <td>2011-11-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Supplies</td>\n",
       "      <td>Yes</td>\n",
       "      <td>7.300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9990</th>\n",
       "      <td>CA-2014-121258</td>\n",
       "      <td>FUR-FU-10000747</td>\n",
       "      <td>2014-02-27</td>\n",
       "      <td>2014-03-04</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>Yes</td>\n",
       "      <td>91.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9991</th>\n",
       "      <td>CA-2014-121258</td>\n",
       "      <td>TEC-PH-10003645</td>\n",
       "      <td>2014-02-27</td>\n",
       "      <td>2014-03-04</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Phones</td>\n",
       "      <td>Yes</td>\n",
       "      <td>258.576</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9992</th>\n",
       "      <td>CA-2014-121258</td>\n",
       "      <td>OFF-PA-10004041</td>\n",
       "      <td>2014-02-27</td>\n",
       "      <td>2014-03-04</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Paper</td>\n",
       "      <td>Yes</td>\n",
       "      <td>29.600</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>800 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "18    CA-2011-143336  OFF-AR-10003056 2011-08-27 2011-09-01  Office Supplies   \n",
       "19    CA-2011-143336  TEC-PH-10001949 2011-08-27 2011-09-01       Technology   \n",
       "20    CA-2011-143336  OFF-BI-10002215 2011-08-27 2011-09-01  Office Supplies   \n",
       "55    CA-2013-111682  OFF-ST-10000604 2013-06-18 2013-06-19  Office Supplies   \n",
       "56    CA-2013-111682  OFF-PA-10001569 2013-06-18 2013-06-19  Office Supplies   \n",
       "...              ...              ...        ...        ...              ...   \n",
       "9957  US-2011-143287  OFF-PA-10004039 2011-11-11 2011-11-17  Office Supplies   \n",
       "9958  US-2011-143287  OFF-SU-10001574 2011-11-11 2011-11-17  Office Supplies   \n",
       "9990  CA-2014-121258  FUR-FU-10000747 2014-02-27 2014-03-04        Furniture   \n",
       "9991  CA-2014-121258  TEC-PH-10003645 2014-02-27 2014-03-04       Technology   \n",
       "9992  CA-2014-121258  OFF-PA-10004041 2014-02-27 2014-03-04  Office Supplies   \n",
       "\n",
       "     Sub-Category Returned    Sales  \n",
       "18            Art      Yes    8.560  \n",
       "19         Phones      Yes  213.480  \n",
       "20        Binders      Yes   22.720  \n",
       "55        Storage      Yes  208.560  \n",
       "56          Paper      Yes   32.400  \n",
       "...           ...      ...      ...  \n",
       "9957        Paper      Yes  223.920  \n",
       "9958     Supplies      Yes    7.300  \n",
       "9990  Furnishings      Yes   91.960  \n",
       "9991       Phones      Yes  258.576  \n",
       "9992        Paper      Yes   29.600  \n",
       "\n",
       "[800 rows x 8 columns]"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Want to check if there are any 'Yes' in our returned column\n",
    "null_ct = return_items.query(\"Returned == 'Yes'\")\n",
    "null_ct"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "fcce2b91-1ba7-469d-8a62-c6a721ddc4f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Order ID\n",
       "CA-2011-100006    1\n",
       "CA-2011-100090    2\n",
       "CA-2011-100293    1\n",
       "CA-2011-100328    1\n",
       "CA-2011-100363    2\n",
       "Name: Product ID, dtype: int64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Group the Order ID by Product ID count\n",
    "items_per_id = return_items.groupby('Order ID')['Product ID'].count()\n",
    "items_per_id.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "f2209a5b-f12b-4092-b7ca-07feb265b338",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Total_Products</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-100006</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-100090</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-100293</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-100328</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-100363</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID  Total_Products\n",
       "0  CA-2011-100006               1\n",
       "1  CA-2011-100090               2\n",
       "2  CA-2011-100293               1\n",
       "3  CA-2011-100328               1\n",
       "4  CA-2011-100363               2"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Notice how our previous input doesn't look like a data frame. How can we do that?\n",
    "# .reset_index()\n",
    "# Let's say we also want to rename our columns\n",
    "items_per_id =return_items.groupby('Order ID')['Product ID'].count().reset_index()\n",
    "items_per_id =items_per_id.rename(columns = {'Product ID':'Total_Products'})\n",
    "items_per_id.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "cca3af55-ec4b-400c-9eba-ffa0d21d6e3e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Total_Products</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-100090</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-100363</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>CA-2011-100678</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>CA-2011-100706</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CA-2011-100762</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>CA-2011-100895</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>CA-2011-100916</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>CA-2011-101560</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>CA-2011-101602</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>CA-2011-101931</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>CA-2011-102274</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>CA-2011-102330</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>CA-2011-102652</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>CA-2011-102673</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>CA-2011-102869</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>CA-2011-102988</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>CA-2011-103100</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>CA-2011-103310</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>CA-2011-103317</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>CA-2011-103331</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          Order ID  Total_Products\n",
       "1   CA-2011-100090               2\n",
       "4   CA-2011-100363               2\n",
       "6   CA-2011-100678               4\n",
       "7   CA-2011-100706               2\n",
       "8   CA-2011-100762               4\n",
       "12  CA-2011-100895               3\n",
       "13  CA-2011-100916               3\n",
       "23  CA-2011-101560               4\n",
       "24  CA-2011-101602               2\n",
       "27  CA-2011-101931               5\n",
       "30  CA-2011-102274               4\n",
       "32  CA-2011-102330               2\n",
       "34  CA-2011-102652               4\n",
       "35  CA-2011-102673               4\n",
       "36  CA-2011-102869               4\n",
       "37  CA-2011-102988               5\n",
       "40  CA-2011-103100               2\n",
       "43  CA-2011-103310               4\n",
       "44  CA-2011-103317               3\n",
       "45  CA-2011-103331               3"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Show Order IDs with more than 1 Product\n",
    "# Using query method, we want total products > 1\n",
    "items_per_id2 = items_per_id.query('Total_Products > 1')\n",
    "items_per_id2.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "df9b6545-5256-4fb6-bbe3-4cef281438e1",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Index(['Order ID', 'Total_Products'], dtype='object')\n",
      "Index(['Order ID', 'Product ID', 'Order Date', 'Ship Date', 'Category',\n",
      "       'Sub-Category', 'Returned', 'Sales'],\n",
      "      dtype='object')\n"
     ]
    }
   ],
   "source": [
    "# Challenge: Merge items_per_id with return_items\n",
    "print(items_per_id.columns)\n",
    "print(return_items.columns)\n",
    "# We can join on Order ID"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "e31ed27d-d8b9-4940-ac7f-0bb3c1e5582c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "5009\n",
      "9994\n"
     ]
    }
   ],
   "source": [
    "# Let's merge with our larger dataset first. Which is larger?\n",
    "print(len(items_per_id))\n",
    "print(len(return_items))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "c1d1e5dd-d5c3-4eff-b6f2-3fcedad409c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products  \n",
       "0    Bookcases      NaN  261.9600               2  \n",
       "1       Chairs      NaN  731.9400               2  \n",
       "2       Labels      NaN   14.6200               1  \n",
       "3       Tables      NaN  957.5775               2  \n",
       "4      Storage      NaN   22.3680               2  "
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Left merge, on Order ID\n",
    "# Our Total_products is kind of like a window function from SQL. For every order ID there is a count for that order ID\n",
    "items_returned = return_items.merge(items_per_id, how = 'left', on = 'Order ID')\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "03436770-22b3-4a41-a191-2ca26282a86d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 9994 entries, 0 to 9993\n",
      "Data columns (total 9 columns):\n",
      " #   Column          Non-Null Count  Dtype         \n",
      "---  ------          --------------  -----         \n",
      " 0   Order ID        9994 non-null   object        \n",
      " 1   Product ID      9994 non-null   object        \n",
      " 2   Order Date      9994 non-null   datetime64[ns]\n",
      " 3   Ship Date       9994 non-null   datetime64[ns]\n",
      " 4   Category        9994 non-null   object        \n",
      " 5   Sub-Category    9994 non-null   object        \n",
      " 6   Returned        800 non-null    object        \n",
      " 7   Sales           9994 non-null   float64       \n",
      " 8   Total_Products  9994 non-null   int64         \n",
      "dtypes: datetime64[ns](2), float64(1), int64(1), object(5)\n",
      "memory usage: 702.8+ KB\n"
     ]
    }
   ],
   "source": [
    "# Let's do a data check: We should still have out 9994\n",
    "items_returned.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "bbe85b63-7061-46e3-8890-bb2dcc20ad9b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "datetime.date(2024, 11, 26)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Print today's date\n",
    "currentdate = pd.to_datetime('today').date()\n",
    "currentdate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "2b6ac604-5c3c-4dba-95c0-49c9e5044886",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "2024\n",
      "11\n",
      "26\n"
     ]
    }
   ],
   "source": [
    "# Current date\n",
    "print(currentdate.year)\n",
    "print(currentdate.month)\n",
    "print(currentdate.day)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "2d31d0f8-6acb-4f4c-97b2-71e1cb80c55c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr  \n",
       "0    Bookcases      NaN  261.9600               2    2013  \n",
       "1       Chairs      NaN  731.9400               2    2013  \n",
       "2       Labels      NaN   14.6200               1    2013  \n",
       "3       Tables      NaN  957.5775               2    2012  \n",
       "4      Storage      NaN   22.3680               2    2012  "
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Took ship year from ship date, and put it into a new column\n",
    "items_returned['Ship_Yr'] = items_returned['Ship Date'].dt.strftime('%Y')\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "b4542d8f-dfb1-46be-8f24-eb0e79ad1202",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \n",
       "0    Bookcases      NaN  261.9600               2    2013     2013  \n",
       "1       Chairs      NaN  731.9400               2    2013     2013  \n",
       "2       Labels      NaN   14.6200               1    2013     2013  \n",
       "3       Tables      NaN  957.5775               2    2012     2012  \n",
       "4      Storage      NaN   22.3680               2    2012     2012  "
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Same thing with order year\n",
    "items_returned['Order_Yr'] = items_returned['Order Date'].dt.strftime('%Y')\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "a4ae7d8f-42f1-4ef2-9aa7-ef88485b373f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \n",
       "0    Bookcases      NaN  261.9600               2    2013     2013     2013-11  \n",
       "1       Chairs      NaN  731.9400               2    2013     2013     2013-11  \n",
       "2       Labels      NaN   14.6200               1    2013     2013     2013-06  \n",
       "3       Tables      NaN  957.5775               2    2012     2012     2012-10  \n",
       "4      Storage      NaN   22.3680               2    2012     2012     2012-10  "
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's say we want to do the year and month\n",
    "items_returned['Order_MonYr'] = items_returned['Order Date'].dt.strftime('%Y-%m')\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "4f9d7ec2-2e28-422d-add3-188562abbd2c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Recall to delete colum\n",
    "# del items_returned['Order_Yr']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "0c363cc3-8715-4534-9c37-442ced55b8ad",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-06</td>\n",
       "      <td>4 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "0    Bookcases      NaN  261.9600               2    2013     2013   \n",
       "1       Chairs      NaN  731.9400               2    2013     2013   \n",
       "2       Labels      NaN   14.6200               1    2013     2013   \n",
       "3       Tables      NaN  957.5775               2    2012     2012   \n",
       "4      Storage      NaN   22.3680               2    2012     2012   \n",
       "\n",
       "  Order_MonYr Num_Days  \n",
       "0     2013-11   3 days  \n",
       "1     2013-11   3 days  \n",
       "2     2013-06   4 days  \n",
       "3     2012-10   7 days  \n",
       "4     2012-10   7 days  "
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "items_returned['Num_Days'] = items_returned['Ship Date'] - items_returned['Order Date']\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "48349fef-d323-4edc-9f04-a351fb78512e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "      <td>11 days 01:21:44.694451194</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "      <td>11 days 01:21:44.694451194</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-06</td>\n",
       "      <td>4 days</td>\n",
       "      <td>11 days 11:09:34.831437495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "      <td>12 days 03:16:09.351985441</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "      <td>12 days 03:16:09.351985441</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "0    Bookcases      NaN  261.9600               2    2013     2013   \n",
       "1       Chairs      NaN  731.9400               2    2013     2013   \n",
       "2       Labels      NaN   14.6200               1    2013     2013   \n",
       "3       Tables      NaN  957.5775               2    2012     2012   \n",
       "4      Storage      NaN   22.3680               2    2012     2012   \n",
       "\n",
       "  Order_MonYr Num_Days          Num_Days_from_Cur  \n",
       "0     2013-11   3 days 11 days 01:21:44.694451194  \n",
       "1     2013-11   3 days 11 days 01:21:44.694451194  \n",
       "2     2013-06   4 days 11 days 11:09:34.831437495  \n",
       "3     2012-10   7 days 12 days 03:16:09.351985441  \n",
       "4     2012-10   7 days 12 days 03:16:09.351985441  "
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Can subtract it from current date as well\n",
    "items_returned['Num_Days_from_Cur'] = (datetime.now() - items_returned['Order Date'])/365\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d4f2a965-f391-4be2-8c22-b569b084e486",
   "metadata": {},
   "source": [
    "### Filtering Data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "b5f40bdc-ea37-4ed1-89b4-b77127263561",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-BO-10001798</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>261.9600</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "      <td>11 days 01:21:44.694451194</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2013-152156</td>\n",
       "      <td>FUR-CH-10000454</td>\n",
       "      <td>2013-11-09</td>\n",
       "      <td>2013-11-12</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>731.9400</td>\n",
       "      <td>2</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-11</td>\n",
       "      <td>3 days</td>\n",
       "      <td>11 days 01:21:44.694451194</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2013-138688</td>\n",
       "      <td>OFF-LA-10000240</td>\n",
       "      <td>2013-06-13</td>\n",
       "      <td>2013-06-17</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Labels</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.6200</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-06</td>\n",
       "      <td>4 days</td>\n",
       "      <td>11 days 11:09:34.831437495</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>FUR-TA-10000577</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>957.5775</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "      <td>12 days 03:16:09.351985441</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.3680</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "      <td>12 days 03:16:09.351985441</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2013-152156  FUR-BO-10001798 2013-11-09 2013-11-12        Furniture   \n",
       "1  CA-2013-152156  FUR-CH-10000454 2013-11-09 2013-11-12        Furniture   \n",
       "2  CA-2013-138688  OFF-LA-10000240 2013-06-13 2013-06-17  Office Supplies   \n",
       "3  US-2012-108966  FUR-TA-10000577 2012-10-11 2012-10-18        Furniture   \n",
       "4  US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "0    Bookcases      NaN  261.9600               2    2013     2013   \n",
       "1       Chairs      NaN  731.9400               2    2013     2013   \n",
       "2       Labels      NaN   14.6200               1    2013     2013   \n",
       "3       Tables      NaN  957.5775               2    2012     2012   \n",
       "4      Storage      NaN   22.3680               2    2012     2012   \n",
       "\n",
       "  Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  \n",
       "0     2013-11   3 days 11 days 01:21:44.694451194  2013  \n",
       "1     2013-11   3 days 11 days 01:21:44.694451194  2013  \n",
       "2     2013-06   4 days 11 days 11:09:34.831437495  2013  \n",
       "3     2012-10   7 days 12 days 03:16:09.351985441  2012  \n",
       "4     2012-10   7 days 12 days 03:16:09.351985441  2012  "
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Let's sparse the date data to create a year column\n",
    "items_returned['Yr2'] = items_returned['Order Date'].dt.year\n",
    "items_returned.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "47b60809-44ea-4163-99c4-b4a5b82ba9ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>US-2012-108966</td>\n",
       "      <td>OFF-ST-10000760</td>\n",
       "      <td>2012-10-11</td>\n",
       "      <td>2012-10-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>22.368</td>\n",
       "      <td>2</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012</td>\n",
       "      <td>2012-10</td>\n",
       "      <td>7 days</td>\n",
       "      <td>12 days 03:16:09.351985441</td>\n",
       "      <td>2012</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>CA-2011-105893</td>\n",
       "      <td>OFF-ST-10004186</td>\n",
       "      <td>2011-11-11</td>\n",
       "      <td>2011-11-18</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>665.880</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-11</td>\n",
       "      <td>7 days</td>\n",
       "      <td>13 days 01:17:47.982122427</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>CA-2011-167164</td>\n",
       "      <td>OFF-ST-10000107</td>\n",
       "      <td>2011-05-13</td>\n",
       "      <td>2011-05-15</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>55.500</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-05</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 13:15:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>CA-2013-101343</td>\n",
       "      <td>OFF-ST-10003479</td>\n",
       "      <td>2013-07-18</td>\n",
       "      <td>2013-07-23</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>77.880</td>\n",
       "      <td>1</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013</td>\n",
       "      <td>2013-07</td>\n",
       "      <td>5 days</td>\n",
       "      <td>11 days 08:51:29.899930646</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>CA-2014-139619</td>\n",
       "      <td>OFF-ST-10003282</td>\n",
       "      <td>2014-09-20</td>\n",
       "      <td>2014-09-24</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>95.616</td>\n",
       "      <td>1</td>\n",
       "      <td>2014</td>\n",
       "      <td>2014</td>\n",
       "      <td>2014-09</td>\n",
       "      <td>4 days</td>\n",
       "      <td>10 days 04:39:00.310889550</td>\n",
       "      <td>2014</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "4   US-2012-108966  OFF-ST-10000760 2012-10-11 2012-10-18  Office Supplies   \n",
       "16  CA-2011-105893  OFF-ST-10004186 2011-11-11 2011-11-18  Office Supplies   \n",
       "17  CA-2011-167164  OFF-ST-10000107 2011-05-13 2011-05-15  Office Supplies   \n",
       "42  CA-2013-101343  OFF-ST-10003479 2013-07-18 2013-07-23  Office Supplies   \n",
       "43  CA-2014-139619  OFF-ST-10003282 2014-09-20 2014-09-24  Office Supplies   \n",
       "\n",
       "   Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "4       Storage      NaN   22.368               2    2012     2012   \n",
       "16      Storage      NaN  665.880               1    2011     2011   \n",
       "17      Storage      NaN   55.500               1    2011     2011   \n",
       "42      Storage      NaN   77.880               1    2013     2013   \n",
       "43      Storage      NaN   95.616               1    2014     2014   \n",
       "\n",
       "   Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  \n",
       "4      2012-10   7 days 12 days 03:16:09.351985441  2012  \n",
       "16     2011-11   7 days 13 days 01:17:47.982122427  2011  \n",
       "17     2011-05   2 days 13 days 13:15:49.625958043  2011  \n",
       "42     2013-07   5 days 11 days 08:51:29.899930646  2013  \n",
       "43     2014-09   4 days 10 days 04:39:00.310889550  2014  "
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Filtering our data to create a new subset of data, where the only sub category is storage\n",
    "items_returned_storage = items_returned[items_returned['Sub-Category'] == 'Storage']\n",
    "items_returned_storage.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "921b9bfb-61a1-4892-9876-80e30ee86098",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>CA-2011-115812</td>\n",
       "      <td>FUR-FU-10001487</td>\n",
       "      <td>2011-06-09</td>\n",
       "      <td>2011-06-14</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>48.860</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-06</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 11:29:18.393081331</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>CA-2011-115812</td>\n",
       "      <td>OFF-AR-10002833</td>\n",
       "      <td>2011-06-09</td>\n",
       "      <td>2011-06-14</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7.280</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-06</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 11:29:18.393081331</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>CA-2011-115812</td>\n",
       "      <td>TEC-PH-10002275</td>\n",
       "      <td>2011-06-09</td>\n",
       "      <td>2011-06-14</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Phones</td>\n",
       "      <td>NaN</td>\n",
       "      <td>907.152</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-06</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 11:29:18.393081331</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CA-2011-115812</td>\n",
       "      <td>OFF-BI-10003910</td>\n",
       "      <td>2011-06-09</td>\n",
       "      <td>2011-06-14</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Binders</td>\n",
       "      <td>NaN</td>\n",
       "      <td>18.504</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-06</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 11:29:18.393081331</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>CA-2011-115812</td>\n",
       "      <td>OFF-AP-10002892</td>\n",
       "      <td>2011-06-09</td>\n",
       "      <td>2011-06-14</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Appliances</td>\n",
       "      <td>NaN</td>\n",
       "      <td>114.900</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-06</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 11:29:18.393081331</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "5  CA-2011-115812  FUR-FU-10001487 2011-06-09 2011-06-14        Furniture   \n",
       "6  CA-2011-115812  OFF-AR-10002833 2011-06-09 2011-06-14  Office Supplies   \n",
       "7  CA-2011-115812  TEC-PH-10002275 2011-06-09 2011-06-14       Technology   \n",
       "8  CA-2011-115812  OFF-BI-10003910 2011-06-09 2011-06-14  Office Supplies   \n",
       "9  CA-2011-115812  OFF-AP-10002892 2011-06-09 2011-06-14  Office Supplies   \n",
       "\n",
       "  Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \\\n",
       "5  Furnishings      NaN   48.860               7    2011     2011     2011-06   \n",
       "6          Art      NaN    7.280               7    2011     2011     2011-06   \n",
       "7       Phones      NaN  907.152               7    2011     2011     2011-06   \n",
       "8      Binders      NaN   18.504               7    2011     2011     2011-06   \n",
       "9   Appliances      NaN  114.900               7    2011     2011     2011-06   \n",
       "\n",
       "  Num_Days          Num_Days_from_Cur   Yr2  \n",
       "5   5 days 13 days 11:29:18.393081331  2011  \n",
       "6   5 days 13 days 11:29:18.393081331  2011  \n",
       "7   5 days 13 days 11:29:18.393081331  2011  \n",
       "8   5 days 13 days 11:29:18.393081331  2011  \n",
       "9   5 days 13 days 11:29:18.393081331  2011  "
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Filter data to only orders that were placed in 2011\n",
    "items_returned_2011 = items_returned[items_returned['Order Date'].dt.year == 2011]\n",
    "items_returned_2011.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "409dd70f-365c-4e6d-9c0d-a5f9b341fd34",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>81</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>82</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>146</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>481</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "46   CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "81   CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "82   CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "146  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "481  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "\n",
       "    Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "46       Storage      NaN  211.960               1    2011     2011   \n",
       "81           Art      NaN   14.900               2    2011     2011   \n",
       "82       Storage      NaN   21.390               2    2011     2011   \n",
       "146  Furnishings      NaN   93.888               1    2011     2011   \n",
       "481  Accessories      NaN    9.090               1    2011     2011   \n",
       "\n",
       "    Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  \n",
       "46      2011-10   5 days 13 days 02:44:35.653355304  2011  \n",
       "81      2011-10   4 days 13 days 03:16:09.351985441  2011  \n",
       "82      2011-10   4 days 13 days 03:16:09.351985441  2011  \n",
       "146     2011-10   6 days 13 days 02:36:42.228697769  2011  \n",
       "481     2011-10   4 days 13 days 03:39:49.625958043  2011  "
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "items_returned_2011s = items_returned.query(\"Order_MonYr == '2011-10'\")\n",
    "items_returned_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "df6e2aba-c3d0-4381-bbef-cc75c57f55bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Can export certain tables to other file types\n",
    "items_returned_2011s.to_csv('Items_Returned_2011s.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "ee797b5a-ee09-4597-baf8-019bcf1a2df0",
   "metadata": {},
   "outputs": [],
   "source": [
    "items_returned_2011s.to_excel('Items_Returned_2011s.xlsx')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b984ad7c-703b-43c5-aa39-9506e1818784",
   "metadata": {},
   "source": [
    "### Using iloc and loc for selectin rows & columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "37669934-e03c-445d-95bc-762d7b878e2e",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>46</td>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>81</td>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>82</td>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>146</td>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>481</td>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   index        Order ID       Product ID Order Date  Ship Date  \\\n",
       "0     46  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25   \n",
       "1     81  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16   \n",
       "2     82  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16   \n",
       "3    146  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28   \n",
       "4    481  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10   \n",
       "\n",
       "          Category Sub-Category Returned    Sales  Total_Products Ship_Yr  \\\n",
       "0  Office Supplies      Storage      NaN  211.960               1    2011   \n",
       "1  Office Supplies          Art      NaN   14.900               2    2011   \n",
       "2  Office Supplies      Storage      NaN   21.390               2    2011   \n",
       "3        Furniture  Furnishings      NaN   93.888               1    2011   \n",
       "4       Technology  Accessories      NaN    9.090               1    2011   \n",
       "\n",
       "  Order_Yr Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  \n",
       "0     2011     2011-10   5 days 13 days 02:44:35.653355304  2011  \n",
       "1     2011     2011-10   4 days 13 days 03:16:09.351985441  2011  \n",
       "2     2011     2011-10   4 days 13 days 03:16:09.351985441  2011  \n",
       "3     2011     2011-10   6 days 13 days 02:36:42.228697769  2011  \n",
       "4     2011     2011-10   4 days 13 days 03:39:49.625958043  2011  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Using iloc to extract a column\n",
    "items_returned_2011s = items_returned_2011s.reset_index()\n",
    "items_returned_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "7a89bc95-c41d-4dc8-8ebb-845822ed5828",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "4  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "\n",
       "  Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \\\n",
       "0      Storage      NaN  211.960               1    2011     2011     2011-10   \n",
       "1          Art      NaN   14.900               2    2011     2011     2011-10   \n",
       "2      Storage      NaN   21.390               2    2011     2011     2011-10   \n",
       "3  Furnishings      NaN   93.888               1    2011     2011     2011-10   \n",
       "4  Accessories      NaN    9.090               1    2011     2011     2011-10   \n",
       "\n",
       "  Num_Days          Num_Days_from_Cur   Yr2  \n",
       "0   5 days 13 days 02:44:35.653355304  2011  \n",
       "1   4 days 13 days 03:16:09.351985441  2011  \n",
       "2   4 days 13 days 03:16:09.351985441  2011  \n",
       "3   6 days 13 days 02:36:42.228697769  2011  \n",
       "4   4 days 13 days 03:39:49.625958043  2011  "
      ]
     },
     "execution_count": 46,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "del items_returned_2011s['index']\n",
    "items_returned_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "33f37fc1-8935-4d31-9e91-65e212a25b3e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Order ID                         CA-2011-146703\n",
       "Product ID                      OFF-ST-10001713\n",
       "Order Date                  2011-10-20 00:00:00\n",
       "Ship Date                   2011-10-25 00:00:00\n",
       "Category                        Office Supplies\n",
       "Sub-Category                            Storage\n",
       "Returned                                    NaN\n",
       "Sales                                    211.96\n",
       "Total_Products                                1\n",
       "Ship_Yr                                    2011\n",
       "Order_Yr                                   2011\n",
       "Order_MonYr                             2011-10\n",
       "Num_Days                        5 days 00:00:00\n",
       "Num_Days_from_Cur    13 days 02:44:35.653355304\n",
       "Yr2                                        2011\n",
       "Name: 0, dtype: object"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Return first row of data\n",
    "# First row is zero because the index starts at 0\n",
    "items_returned_2011s.iloc[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "4fe67bcf-9c1c-487c-ae1a-a7b0ccc8973f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'CA-2011-146703'"
      ]
     },
     "execution_count": 48,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Pulling a certain value from the entire table\n",
    "# .iloc[column, row]\n",
    "items_returned_2011s.iloc[0, 0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "fe2835ad-48d9-4e51-8bbd-d0334ddcc493",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies\n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies\n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies\n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# can use it to return a range of items\n",
    "items_returned_2011s.iloc[0:4, 0:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "c7c37745-dedd-4db4-a8c8-39ac1eb42a98",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0    2011\n",
       "1    2011\n",
       "2    2011\n",
       "3    2011\n",
       "4    2011\n",
       "Name: Yr2, dtype: int32"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Negative value will start counting from the end of the table\n",
    "items_returned_2011s.iloc[0:5, -1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "311d9a95-1ce2-4737-9233-555cc4055a6d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       211.960\n",
       "1        14.900\n",
       "2        21.390\n",
       "3        93.888\n",
       "4         9.090\n",
       "         ...   \n",
       "154      75.880\n",
       "155       5.312\n",
       "156     177.000\n",
       "157      79.450\n",
       "158    1628.820\n",
       "Name: Sales, Length: 159, dtype: float64"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Want to return just the sales column\n",
    "# 0: -- no end range, so it will output all entries\n",
    "items_returned_2011s.iloc[0:, 7]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "3c04a84c-079a-49ce-a09d-979afd5bd9bb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0      211.960000\n",
       "1        7.450000\n",
       "2       10.695000\n",
       "3       93.888000\n",
       "4        9.090000\n",
       "          ...    \n",
       "154     37.940000\n",
       "155      5.312000\n",
       "156     59.000000\n",
       "157     26.483333\n",
       "158    542.940000\n",
       "Length: 159, dtype: float64"
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Divide sales by Total products\n",
    "items_returned_2011s.iloc[0:, 7]/items_returned_2011s.iloc[0:, 8]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "b23f272f-c18f-42f3-ad9d-2c01ecdd2c41",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "      <th>Price_Per_Prod</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "      <td>211.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>7.450</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>10.695</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>93.888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "      <td>9.090</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "4  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "\n",
       "  Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \\\n",
       "0      Storage      NaN  211.960               1    2011     2011     2011-10   \n",
       "1          Art      NaN   14.900               2    2011     2011     2011-10   \n",
       "2      Storage      NaN   21.390               2    2011     2011     2011-10   \n",
       "3  Furnishings      NaN   93.888               1    2011     2011     2011-10   \n",
       "4  Accessories      NaN    9.090               1    2011     2011     2011-10   \n",
       "\n",
       "  Num_Days          Num_Days_from_Cur   Yr2  Price_Per_Prod  \n",
       "0   5 days 13 days 02:44:35.653355304  2011         211.960  \n",
       "1   4 days 13 days 03:16:09.351985441  2011           7.450  \n",
       "2   4 days 13 days 03:16:09.351985441  2011          10.695  \n",
       "3   6 days 13 days 02:36:42.228697769  2011          93.888  \n",
       "4   4 days 13 days 03:39:49.625958043  2011           9.090  "
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Can add this as new column in DF\n",
    "items_returned_2011s['Price_Per_Prod'] = items_returned_2011s.iloc[0:, 7]/items_returned_2011s.iloc[0:, 8]\n",
    "items_returned_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "057eb9c2-1c46-40a7-b5d2-add0481501d4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "      <th>Price_Per_Prod</th>\n",
       "      <th>Price_Per_Prod2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "      <td>211.960</td>\n",
       "      <td>211.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>7.450</td>\n",
       "      <td>7.450</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>10.695</td>\n",
       "      <td>10.695</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>93.888</td>\n",
       "      <td>93.888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "      <td>9.090</td>\n",
       "      <td>9.090</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "4  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "\n",
       "  Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \\\n",
       "0      Storage      NaN  211.960               1    2011     2011     2011-10   \n",
       "1          Art      NaN   14.900               2    2011     2011     2011-10   \n",
       "2      Storage      NaN   21.390               2    2011     2011     2011-10   \n",
       "3  Furnishings      NaN   93.888               1    2011     2011     2011-10   \n",
       "4  Accessories      NaN    9.090               1    2011     2011     2011-10   \n",
       "\n",
       "  Num_Days          Num_Days_from_Cur   Yr2  Price_Per_Prod  Price_Per_Prod2  \n",
       "0   5 days 13 days 02:44:35.653355304  2011         211.960          211.960  \n",
       "1   4 days 13 days 03:16:09.351985441  2011           7.450            7.450  \n",
       "2   4 days 13 days 03:16:09.351985441  2011          10.695           10.695  \n",
       "3   6 days 13 days 02:36:42.228697769  2011          93.888           93.888  \n",
       "4   4 days 13 days 03:39:49.625958043  2011           9.090            9.090  "
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Can calculate sales/products in a different way\n",
    "# Can add this as new column in DF\n",
    "items_returned_2011s['Price_Per_Prod2'] = items_returned_2011s.iloc[0:]['Sales']/items_returned_2011s.iloc[0:]['Total_Products']\n",
    "items_returned_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "95f4df98-ca36-4b1a-9bdf-c65324cc28b3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "      <th>Price_Per_Prod</th>\n",
       "      <th>Price_Per_Prod2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "      <td>211.960</td>\n",
       "      <td>211.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>7.450</td>\n",
       "      <td>7.450</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>10.695</td>\n",
       "      <td>10.695</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>93.888</td>\n",
       "      <td>93.888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "      <td>9.090</td>\n",
       "      <td>9.090</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "4  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "\n",
       "  Sub-Category Returned    Sales  Total_Products Ship_Yr Order_Yr Order_MonYr  \\\n",
       "0      Storage      NaN  211.960               1    2011     2011     2011-10   \n",
       "1          Art      NaN   14.900               2    2011     2011     2011-10   \n",
       "2      Storage      NaN   21.390               2    2011     2011     2011-10   \n",
       "3  Furnishings      NaN   93.888               1    2011     2011     2011-10   \n",
       "4  Accessories      NaN    9.090               1    2011     2011     2011-10   \n",
       "\n",
       "  Num_Days          Num_Days_from_Cur   Yr2  Price_Per_Prod  Price_Per_Prod2  \n",
       "0   5 days 13 days 02:44:35.653355304  2011         211.960          211.960  \n",
       "1   4 days 13 days 03:16:09.351985441  2011           7.450            7.450  \n",
       "2   4 days 13 days 03:16:09.351985441  2011          10.695           10.695  \n",
       "3   6 days 13 days 02:36:42.228697769  2011          93.888           93.888  \n",
       "4   4 days 13 days 03:39:49.625958043  2011           9.090            9.090  "
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Rename our data frame\n",
    "ir_2011s = items_returned_2011s\n",
    "ir_2011s.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "18af882a-83f8-462e-bcb0-50668b562e7c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "      <th>Price_Per_Prod</th>\n",
       "      <th>Price_Per_Prod2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>93.888000</td>\n",
       "      <td>93.888000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>CA-2011-117429</td>\n",
       "      <td>FUR-FU-10000222</td>\n",
       "      <td>2011-10-07</td>\n",
       "      <td>2011-10-13</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>129.920</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 03:35:52.913629276</td>\n",
       "      <td>2011</td>\n",
       "      <td>129.920000</td>\n",
       "      <td>129.920000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>CA-2011-151995</td>\n",
       "      <td>FUR-TA-10002903</td>\n",
       "      <td>2011-10-13</td>\n",
       "      <td>2011-10-15</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1298.550</td>\n",
       "      <td>4</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 03:12:12.639656673</td>\n",
       "      <td>2011</td>\n",
       "      <td>324.637500</td>\n",
       "      <td>324.637500</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>CA-2011-153976</td>\n",
       "      <td>FUR-CH-10002880</td>\n",
       "      <td>2011-10-03</td>\n",
       "      <td>2011-10-08</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>258.279</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:51:39.762944345</td>\n",
       "      <td>2011</td>\n",
       "      <td>258.279000</td>\n",
       "      <td>258.279000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>CA-2011-142587</td>\n",
       "      <td>FUR-TA-10000617</td>\n",
       "      <td>2011-10-21</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>409.590</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>1 days</td>\n",
       "      <td>13 days 02:40:38.941026536</td>\n",
       "      <td>2011</td>\n",
       "      <td>204.795000</td>\n",
       "      <td>204.795000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>CA-2011-110408</td>\n",
       "      <td>FUR-CH-10003774</td>\n",
       "      <td>2011-10-18</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>545.880</td>\n",
       "      <td>3</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:52:29.078012838</td>\n",
       "      <td>2011</td>\n",
       "      <td>181.960000</td>\n",
       "      <td>181.960000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>CA-2011-106439</td>\n",
       "      <td>FUR-CH-10003833</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-04</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>146.352</td>\n",
       "      <td>9</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>16.261333</td>\n",
       "      <td>16.261333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>CA-2011-157882</td>\n",
       "      <td>FUR-TA-10001866</td>\n",
       "      <td>2011-10-03</td>\n",
       "      <td>2011-10-08</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>143.432</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:51:39.762944345</td>\n",
       "      <td>2011</td>\n",
       "      <td>71.716000</td>\n",
       "      <td>71.716000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>CA-2011-157882</td>\n",
       "      <td>FUR-CH-10002774</td>\n",
       "      <td>2011-10-03</td>\n",
       "      <td>2011-10-08</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>122.352</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:51:39.762944345</td>\n",
       "      <td>2011</td>\n",
       "      <td>61.176000</td>\n",
       "      <td>61.176000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>CA-2011-143182</td>\n",
       "      <td>FUR-FU-10004270</td>\n",
       "      <td>2011-10-15</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>15.384</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:04:19.214999139</td>\n",
       "      <td>2011</td>\n",
       "      <td>15.384000</td>\n",
       "      <td>15.384000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>CA-2011-101931</td>\n",
       "      <td>FUR-BO-10001337</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Bookcases</td>\n",
       "      <td>NaN</td>\n",
       "      <td>616.998</td>\n",
       "      <td>5</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>3 days</td>\n",
       "      <td>13 days 02:13:01.954725167</td>\n",
       "      <td>2011</td>\n",
       "      <td>123.399600</td>\n",
       "      <td>123.399600</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>CA-2011-116834</td>\n",
       "      <td>FUR-FU-10001196</td>\n",
       "      <td>2011-10-11</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>63.470</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:20:06.064314208</td>\n",
       "      <td>2011</td>\n",
       "      <td>31.735000</td>\n",
       "      <td>31.735000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>53</th>\n",
       "      <td>CA-2011-157924</td>\n",
       "      <td>FUR-CH-10000229</td>\n",
       "      <td>2011-10-11</td>\n",
       "      <td>2011-10-13</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>Yes</td>\n",
       "      <td>433.568</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 03:20:06.064314208</td>\n",
       "      <td>2011</td>\n",
       "      <td>216.784000</td>\n",
       "      <td>216.784000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56</th>\n",
       "      <td>CA-2011-145387</td>\n",
       "      <td>FUR-FU-10002364</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.760</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>2.108571</td>\n",
       "      <td>2.108571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>CA-2011-145387</td>\n",
       "      <td>FUR-FU-10000023</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>17.670</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>2.524286</td>\n",
       "      <td>2.524286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>CA-2011-145387</td>\n",
       "      <td>FUR-CH-10002320</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1604.900</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>229.271429</td>\n",
       "      <td>229.271429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>CA-2011-145387</td>\n",
       "      <td>FUR-TA-10003238</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>385.686</td>\n",
       "      <td>7</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>55.098000</td>\n",
       "      <td>55.098000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>CA-2011-162278</td>\n",
       "      <td>FUR-FU-10000448</td>\n",
       "      <td>2011-10-26</td>\n",
       "      <td>2011-10-30</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>63.920</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 02:20:55.379382701</td>\n",
       "      <td>2011</td>\n",
       "      <td>31.960000</td>\n",
       "      <td>31.960000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>63</th>\n",
       "      <td>CA-2011-140403</td>\n",
       "      <td>FUR-CH-10002774</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>122.352</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>0 days</td>\n",
       "      <td>13 days 03:24:02.776642975</td>\n",
       "      <td>2011</td>\n",
       "      <td>61.176000</td>\n",
       "      <td>61.176000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>68</th>\n",
       "      <td>US-2011-122021</td>\n",
       "      <td>FUR-CH-10003761</td>\n",
       "      <td>2011-10-15</td>\n",
       "      <td>2011-10-17</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>183.372</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 03:04:19.214999139</td>\n",
       "      <td>2011</td>\n",
       "      <td>91.686000</td>\n",
       "      <td>91.686000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76</th>\n",
       "      <td>CA-2011-115084</td>\n",
       "      <td>FUR-CH-10004626</td>\n",
       "      <td>2011-10-18</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>605.340</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 02:52:29.078012838</td>\n",
       "      <td>2011</td>\n",
       "      <td>605.340000</td>\n",
       "      <td>605.340000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>78</th>\n",
       "      <td>CA-2011-164742</td>\n",
       "      <td>FUR-CH-10002880</td>\n",
       "      <td>2011-10-13</td>\n",
       "      <td>2011-10-18</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>245.980</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 03:12:12.639656673</td>\n",
       "      <td>2011</td>\n",
       "      <td>122.990000</td>\n",
       "      <td>122.990000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>88</th>\n",
       "      <td>CA-2011-114314</td>\n",
       "      <td>FUR-FU-10002107</td>\n",
       "      <td>2011-10-11</td>\n",
       "      <td>2011-10-15</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>8.920</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:20:06.064314208</td>\n",
       "      <td>2011</td>\n",
       "      <td>4.460000</td>\n",
       "      <td>4.460000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>CA-2011-166891</td>\n",
       "      <td>FUR-CH-10003298</td>\n",
       "      <td>2011-10-04</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>589.410</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 03:47:43.050615578</td>\n",
       "      <td>2011</td>\n",
       "      <td>589.410000</td>\n",
       "      <td>589.410000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>CA-2011-169684</td>\n",
       "      <td>FUR-TA-10003008</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-23</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>328.590</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>3 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "      <td>164.295000</td>\n",
       "      <td>164.295000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103</th>\n",
       "      <td>CA-2011-108609</td>\n",
       "      <td>FUR-TA-10003954</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>2011-11-02</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>Yes</td>\n",
       "      <td>1421.664</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:01:11.817738865</td>\n",
       "      <td>2011</td>\n",
       "      <td>1421.664000</td>\n",
       "      <td>1421.664000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>104</th>\n",
       "      <td>CA-2011-150329</td>\n",
       "      <td>FUR-FU-10003724</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>2011-10-14</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>46.872</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:24:02.776642975</td>\n",
       "      <td>2011</td>\n",
       "      <td>46.872000</td>\n",
       "      <td>46.872000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>117</th>\n",
       "      <td>CA-2011-100916</td>\n",
       "      <td>FUR-TA-10004607</td>\n",
       "      <td>2011-10-21</td>\n",
       "      <td>2011-10-26</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Tables</td>\n",
       "      <td>NaN</td>\n",
       "      <td>591.320</td>\n",
       "      <td>3</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:40:38.941026536</td>\n",
       "      <td>2011</td>\n",
       "      <td>197.106667</td>\n",
       "      <td>197.106667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>119</th>\n",
       "      <td>CA-2011-151967</td>\n",
       "      <td>FUR-FU-10000193</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-26</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>129.920</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>129.920000</td>\n",
       "      <td>129.920000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>124</th>\n",
       "      <td>CA-2011-120775</td>\n",
       "      <td>FUR-FU-10000758</td>\n",
       "      <td>2011-10-03</td>\n",
       "      <td>2011-10-07</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31.776</td>\n",
       "      <td>5</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:51:39.762944345</td>\n",
       "      <td>2011</td>\n",
       "      <td>6.355200</td>\n",
       "      <td>6.355200</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>155</th>\n",
       "      <td>CA-2011-103086</td>\n",
       "      <td>FUR-FU-10004586</td>\n",
       "      <td>2011-10-17</td>\n",
       "      <td>2011-10-19</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5.312</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:56:25.790341605</td>\n",
       "      <td>2011</td>\n",
       "      <td>5.312000</td>\n",
       "      <td>5.312000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>158</th>\n",
       "      <td>CA-2011-151330</td>\n",
       "      <td>FUR-CH-10000749</td>\n",
       "      <td>2011-10-14</td>\n",
       "      <td>2011-10-17</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Chairs</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1628.820</td>\n",
       "      <td>3</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>3 days</td>\n",
       "      <td>13 days 03:08:15.927327906</td>\n",
       "      <td>2011</td>\n",
       "      <td>542.940000</td>\n",
       "      <td>542.940000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           Order ID       Product ID Order Date  Ship Date   Category  \\\n",
       "3    CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28  Furniture   \n",
       "6    CA-2011-117429  FUR-FU-10000222 2011-10-07 2011-10-13  Furniture   \n",
       "8    CA-2011-151995  FUR-TA-10002903 2011-10-13 2011-10-15  Furniture   \n",
       "11   CA-2011-153976  FUR-CH-10002880 2011-10-03 2011-10-08  Furniture   \n",
       "14   CA-2011-142587  FUR-TA-10000617 2011-10-21 2011-10-22  Furniture   \n",
       "17   CA-2011-110408  FUR-CH-10003774 2011-10-18 2011-10-20  Furniture   \n",
       "24   CA-2011-106439  FUR-CH-10003833 2011-10-31 2011-11-04  Furniture   \n",
       "27   CA-2011-157882  FUR-TA-10001866 2011-10-03 2011-10-08  Furniture   \n",
       "28   CA-2011-157882  FUR-CH-10002774 2011-10-03 2011-10-08  Furniture   \n",
       "30   CA-2011-143182  FUR-FU-10004270 2011-10-15 2011-10-20  Furniture   \n",
       "48   CA-2011-101931  FUR-BO-10001337 2011-10-28 2011-10-31  Furniture   \n",
       "50   CA-2011-116834  FUR-FU-10001196 2011-10-11 2011-10-16  Furniture   \n",
       "53   CA-2011-157924  FUR-CH-10000229 2011-10-11 2011-10-13  Furniture   \n",
       "56   CA-2011-145387  FUR-FU-10002364 2011-10-31 2011-11-02  Furniture   \n",
       "58   CA-2011-145387  FUR-FU-10000023 2011-10-31 2011-11-02  Furniture   \n",
       "59   CA-2011-145387  FUR-CH-10002320 2011-10-31 2011-11-02  Furniture   \n",
       "60   CA-2011-145387  FUR-TA-10003238 2011-10-31 2011-11-02  Furniture   \n",
       "61   CA-2011-162278  FUR-FU-10000448 2011-10-26 2011-10-30  Furniture   \n",
       "63   CA-2011-140403  FUR-CH-10002774 2011-10-10 2011-10-10  Furniture   \n",
       "68   US-2011-122021  FUR-CH-10003761 2011-10-15 2011-10-17  Furniture   \n",
       "76   CA-2011-115084  FUR-CH-10004626 2011-10-18 2011-10-22  Furniture   \n",
       "78   CA-2011-164742  FUR-CH-10002880 2011-10-13 2011-10-18  Furniture   \n",
       "88   CA-2011-114314  FUR-FU-10002107 2011-10-11 2011-10-15  Furniture   \n",
       "95   CA-2011-166891  FUR-CH-10003298 2011-10-04 2011-10-06  Furniture   \n",
       "96   CA-2011-169684  FUR-TA-10003008 2011-10-20 2011-10-23  Furniture   \n",
       "103  CA-2011-108609  FUR-TA-10003954 2011-10-31 2011-11-02  Furniture   \n",
       "104  CA-2011-150329  FUR-FU-10003724 2011-10-10 2011-10-14  Furniture   \n",
       "117  CA-2011-100916  FUR-TA-10004607 2011-10-21 2011-10-26  Furniture   \n",
       "119  CA-2011-151967  FUR-FU-10000193 2011-10-22 2011-10-26  Furniture   \n",
       "124  CA-2011-120775  FUR-FU-10000758 2011-10-03 2011-10-07  Furniture   \n",
       "155  CA-2011-103086  FUR-FU-10004586 2011-10-17 2011-10-19  Furniture   \n",
       "158  CA-2011-151330  FUR-CH-10000749 2011-10-14 2011-10-17  Furniture   \n",
       "\n",
       "    Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "3    Furnishings      NaN    93.888               1    2011     2011   \n",
       "6    Furnishings      NaN   129.920               1    2011     2011   \n",
       "8         Tables      NaN  1298.550               4    2011     2011   \n",
       "11        Chairs      NaN   258.279               1    2011     2011   \n",
       "14        Tables      NaN   409.590               2    2011     2011   \n",
       "17        Chairs      NaN   545.880               3    2011     2011   \n",
       "24        Chairs      NaN   146.352               9    2011     2011   \n",
       "27        Tables      NaN   143.432               2    2011     2011   \n",
       "28        Chairs      NaN   122.352               2    2011     2011   \n",
       "30   Furnishings      NaN    15.384               1    2011     2011   \n",
       "48     Bookcases      NaN   616.998               5    2011     2011   \n",
       "50   Furnishings      NaN    63.470               2    2011     2011   \n",
       "53        Chairs      Yes   433.568               2    2011     2011   \n",
       "56   Furnishings      NaN    14.760               7    2011     2011   \n",
       "58   Furnishings      NaN    17.670               7    2011     2011   \n",
       "59        Chairs      NaN  1604.900               7    2011     2011   \n",
       "60        Tables      NaN   385.686               7    2011     2011   \n",
       "61   Furnishings      NaN    63.920               2    2011     2011   \n",
       "63        Chairs      NaN   122.352               2    2011     2011   \n",
       "68        Chairs      NaN   183.372               2    2011     2011   \n",
       "76        Chairs      NaN   605.340               1    2011     2011   \n",
       "78        Chairs      NaN   245.980               2    2011     2011   \n",
       "88   Furnishings      NaN     8.920               2    2011     2011   \n",
       "95        Chairs      NaN   589.410               1    2011     2011   \n",
       "96        Tables      NaN   328.590               2    2011     2011   \n",
       "103       Tables      Yes  1421.664               1    2011     2011   \n",
       "104  Furnishings      NaN    46.872               1    2011     2011   \n",
       "117       Tables      NaN   591.320               3    2011     2011   \n",
       "119  Furnishings      NaN   129.920               1    2011     2011   \n",
       "124  Furnishings      NaN    31.776               5    2011     2011   \n",
       "155  Furnishings      NaN     5.312               1    2011     2011   \n",
       "158       Chairs      NaN  1628.820               3    2011     2011   \n",
       "\n",
       "    Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  Price_Per_Prod  \\\n",
       "3       2011-10   6 days 13 days 02:36:42.228697769  2011       93.888000   \n",
       "6       2011-10   6 days 13 days 03:35:52.913629276  2011      129.920000   \n",
       "8       2011-10   2 days 13 days 03:12:12.639656673  2011      324.637500   \n",
       "11      2011-10   5 days 13 days 03:51:39.762944345  2011      258.279000   \n",
       "14      2011-10   1 days 13 days 02:40:38.941026536  2011      204.795000   \n",
       "17      2011-10   2 days 13 days 02:52:29.078012838  2011      181.960000   \n",
       "24      2011-10   4 days 13 days 02:01:11.817738865  2011       16.261333   \n",
       "27      2011-10   5 days 13 days 03:51:39.762944345  2011       71.716000   \n",
       "28      2011-10   5 days 13 days 03:51:39.762944345  2011       61.176000   \n",
       "30      2011-10   5 days 13 days 03:04:19.214999139  2011       15.384000   \n",
       "48      2011-10   3 days 13 days 02:13:01.954725167  2011      123.399600   \n",
       "50      2011-10   5 days 13 days 03:20:06.064314208  2011       31.735000   \n",
       "53      2011-10   2 days 13 days 03:20:06.064314208  2011      216.784000   \n",
       "56      2011-10   2 days 13 days 02:01:11.817738865  2011        2.108571   \n",
       "58      2011-10   2 days 13 days 02:01:11.817738865  2011        2.524286   \n",
       "59      2011-10   2 days 13 days 02:01:11.817738865  2011      229.271429   \n",
       "60      2011-10   2 days 13 days 02:01:11.817738865  2011       55.098000   \n",
       "61      2011-10   4 days 13 days 02:20:55.379382701  2011       31.960000   \n",
       "63      2011-10   0 days 13 days 03:24:02.776642975  2011       61.176000   \n",
       "68      2011-10   2 days 13 days 03:04:19.214999139  2011       91.686000   \n",
       "76      2011-10   4 days 13 days 02:52:29.078012838  2011      605.340000   \n",
       "78      2011-10   5 days 13 days 03:12:12.639656673  2011      122.990000   \n",
       "88      2011-10   4 days 13 days 03:20:06.064314208  2011        4.460000   \n",
       "95      2011-10   2 days 13 days 03:47:43.050615578  2011      589.410000   \n",
       "96      2011-10   3 days 13 days 02:44:35.653355304  2011      164.295000   \n",
       "103     2011-10   2 days 13 days 02:01:11.817738865  2011     1421.664000   \n",
       "104     2011-10   4 days 13 days 03:24:02.776642975  2011       46.872000   \n",
       "117     2011-10   5 days 13 days 02:40:38.941026536  2011      197.106667   \n",
       "119     2011-10   4 days 13 days 02:36:42.228697769  2011      129.920000   \n",
       "124     2011-10   4 days 13 days 03:51:39.762944345  2011        6.355200   \n",
       "155     2011-10   2 days 13 days 02:56:25.790341605  2011        5.312000   \n",
       "158     2011-10   3 days 13 days 03:08:15.927327906  2011      542.940000   \n",
       "\n",
       "     Price_Per_Prod2  \n",
       "3          93.888000  \n",
       "6         129.920000  \n",
       "8         324.637500  \n",
       "11        258.279000  \n",
       "14        204.795000  \n",
       "17        181.960000  \n",
       "24         16.261333  \n",
       "27         71.716000  \n",
       "28         61.176000  \n",
       "30         15.384000  \n",
       "48        123.399600  \n",
       "50         31.735000  \n",
       "53        216.784000  \n",
       "56          2.108571  \n",
       "58          2.524286  \n",
       "59        229.271429  \n",
       "60         55.098000  \n",
       "61         31.960000  \n",
       "63         61.176000  \n",
       "68         91.686000  \n",
       "76        605.340000  \n",
       "78        122.990000  \n",
       "88          4.460000  \n",
       "95        589.410000  \n",
       "96        164.295000  \n",
       "103      1421.664000  \n",
       "104        46.872000  \n",
       "117       197.106667  \n",
       "119       129.920000  \n",
       "124         6.355200  \n",
       "155         5.312000  \n",
       "158       542.940000  "
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Extracting data with .loc\n",
    "ir_2011s.loc[ir_2011s['Category']=='Furniture']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "9a8ebf12-8ec6-47f5-a9a3-837f70af6596",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Office Supplies</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Furniture</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Technology</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Technology</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          Category\n",
       "0  Office Supplies\n",
       "1  Office Supplies\n",
       "2  Office Supplies\n",
       "3        Furniture\n",
       "4       Technology\n",
       "5       Technology"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Extract the first 6 rows, of only the category column\n",
    "ir_2011s.loc[0:5, ['Category']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "41e5aa06-8f60-4ad7-9e18-a164bdf7f62a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order ID</th>\n",
       "      <th>Product ID</th>\n",
       "      <th>Order Date</th>\n",
       "      <th>Ship Date</th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "      <th>Returned</th>\n",
       "      <th>Sales</th>\n",
       "      <th>Total_Products</th>\n",
       "      <th>Ship_Yr</th>\n",
       "      <th>Order_Yr</th>\n",
       "      <th>Order_MonYr</th>\n",
       "      <th>Num_Days</th>\n",
       "      <th>Num_Days_from_Cur</th>\n",
       "      <th>Yr2</th>\n",
       "      <th>Price_Per_Prod</th>\n",
       "      <th>Price_Per_Prod2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>CA-2011-146703</td>\n",
       "      <td>OFF-ST-10001713</td>\n",
       "      <td>2011-10-20</td>\n",
       "      <td>2011-10-25</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>211.960</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>5 days</td>\n",
       "      <td>13 days 02:44:35.653355304</td>\n",
       "      <td>2011</td>\n",
       "      <td>211.960</td>\n",
       "      <td>211.960</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-AR-10002053</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "      <td>NaN</td>\n",
       "      <td>14.900</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>7.450</td>\n",
       "      <td>7.450</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>CA-2011-139451</td>\n",
       "      <td>OFF-ST-10002370</td>\n",
       "      <td>2011-10-12</td>\n",
       "      <td>2011-10-16</td>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>21.390</td>\n",
       "      <td>2</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:16:09.351985441</td>\n",
       "      <td>2011</td>\n",
       "      <td>10.695</td>\n",
       "      <td>10.695</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CA-2011-110072</td>\n",
       "      <td>FUR-FU-10000521</td>\n",
       "      <td>2011-10-22</td>\n",
       "      <td>2011-10-28</td>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "      <td>NaN</td>\n",
       "      <td>93.888</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>6 days</td>\n",
       "      <td>13 days 02:36:42.228697769</td>\n",
       "      <td>2011</td>\n",
       "      <td>93.888</td>\n",
       "      <td>93.888</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>CA-2011-134677</td>\n",
       "      <td>TEC-AC-10001445</td>\n",
       "      <td>2011-10-06</td>\n",
       "      <td>2011-10-10</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "      <td>NaN</td>\n",
       "      <td>9.090</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>4 days</td>\n",
       "      <td>13 days 03:39:49.625958043</td>\n",
       "      <td>2011</td>\n",
       "      <td>9.090</td>\n",
       "      <td>9.090</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>CA-2011-154627</td>\n",
       "      <td>TEC-PH-10001363</td>\n",
       "      <td>2011-10-29</td>\n",
       "      <td>2011-10-31</td>\n",
       "      <td>Technology</td>\n",
       "      <td>Phones</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2735.952</td>\n",
       "      <td>1</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011</td>\n",
       "      <td>2011-10</td>\n",
       "      <td>2 days</td>\n",
       "      <td>13 days 02:09:05.242396400</td>\n",
       "      <td>2011</td>\n",
       "      <td>2735.952</td>\n",
       "      <td>2735.952</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         Order ID       Product ID Order Date  Ship Date         Category  \\\n",
       "0  CA-2011-146703  OFF-ST-10001713 2011-10-20 2011-10-25  Office Supplies   \n",
       "1  CA-2011-139451  OFF-AR-10002053 2011-10-12 2011-10-16  Office Supplies   \n",
       "2  CA-2011-139451  OFF-ST-10002370 2011-10-12 2011-10-16  Office Supplies   \n",
       "3  CA-2011-110072  FUR-FU-10000521 2011-10-22 2011-10-28        Furniture   \n",
       "4  CA-2011-134677  TEC-AC-10001445 2011-10-06 2011-10-10       Technology   \n",
       "5  CA-2011-154627  TEC-PH-10001363 2011-10-29 2011-10-31       Technology   \n",
       "\n",
       "  Sub-Category Returned     Sales  Total_Products Ship_Yr Order_Yr  \\\n",
       "0      Storage      NaN   211.960               1    2011     2011   \n",
       "1          Art      NaN    14.900               2    2011     2011   \n",
       "2      Storage      NaN    21.390               2    2011     2011   \n",
       "3  Furnishings      NaN    93.888               1    2011     2011   \n",
       "4  Accessories      NaN     9.090               1    2011     2011   \n",
       "5       Phones      NaN  2735.952               1    2011     2011   \n",
       "\n",
       "  Order_MonYr Num_Days          Num_Days_from_Cur   Yr2  Price_Per_Prod  \\\n",
       "0     2011-10   5 days 13 days 02:44:35.653355304  2011         211.960   \n",
       "1     2011-10   4 days 13 days 03:16:09.351985441  2011           7.450   \n",
       "2     2011-10   4 days 13 days 03:16:09.351985441  2011          10.695   \n",
       "3     2011-10   6 days 13 days 02:36:42.228697769  2011          93.888   \n",
       "4     2011-10   4 days 13 days 03:39:49.625958043  2011           9.090   \n",
       "5     2011-10   2 days 13 days 02:09:05.242396400  2011        2735.952   \n",
       "\n",
       "   Price_Per_Prod2  \n",
       "0          211.960  \n",
       "1            7.450  \n",
       "2           10.695  \n",
       "3           93.888  \n",
       "4            9.090  \n",
       "5         2735.952  "
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# If we don't specify a column, it'll just give us the first 6 rows of everything\n",
    "ir_2011s.loc[0:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "808a1eeb-9d42-48ca-b08a-aae8d2593bfc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Category</th>\n",
       "      <th>Sub-Category</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Art</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Office Supplies</td>\n",
       "      <td>Storage</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Furniture</td>\n",
       "      <td>Furnishings</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Technology</td>\n",
       "      <td>Accessories</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Technology</td>\n",
       "      <td>Phones</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          Category Sub-Category\n",
       "0  Office Supplies      Storage\n",
       "1  Office Supplies          Art\n",
       "2  Office Supplies      Storage\n",
       "3        Furniture  Furnishings\n",
       "4       Technology  Accessories\n",
       "5       Technology       Phones"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Can extract rows of data and multiple columns at once\n",
    "ir_2011s.loc[0:5, ['Category', 'Sub-Category']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0aa56488-ce49-46cb-bc91-2b6e647474be",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "747d1823-7b6d-47d2-81ed-178e7be55b29",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "58feaf56-7cb1-440d-8e4a-450797d9820f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3368be0f-b826-4c3f-9286-f1c228171cf0",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "82eca4d8-2cf9-4fe8-9801-0d6589d8b1d5",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "037c45a1-5ce6-4139-94dc-911cb5a983f0",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "eb4e6838-2b6e-4edf-8d48-cec003f74e26",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "38f08676-c317-4d34-ac8f-6336012ae482",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "89e50e46-060d-4074-8d42-d717be8de1ad",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "7b34bcb1-66b1-4dc5-89be-5b03360c14f2",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "60b905b6-806c-40b3-bbd1-600c0418526e",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
